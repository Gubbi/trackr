<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">

<dom-module id="kyash-point">
  <style>
    paper-card {
      min-width: 300px;
      width: 90%;
      margin: 8px auto;
      border-top: 2px solid #fefefe;
      background-color: white;
      display: block;
      cursor: pointer;
    }

    paper-input {
      --paper-input-container-input: {
        font-size: 1.1em;
      }
    }

    paper-input[readonly], paper-textarea[readonly] {
      /* line color when the input is unfocused */
      --paper-input-container-underline: {
        display:none;
      }
      --paper-input-container-underline-focus: {
        display:none;
      }
      --paper-input-container-underline-disabled: {
        display:none;
      }
    }

    .card-content {
      padding: 0 16px 8px;
      font-size: 0.8em;
    }

    p {
      font-size: 0.9em;
      margin: 0;
    }

    .surcharge {
      color: rgba(200,0,0,0.6);
      font-size: 0.9em;
      padding-top: 8px;
    }

    h4 {
      margin: 6px 0 4px;
      font-size: 0.95em;
    }
  </style>
  <template>
    <paper-card elevation="{{ele}}">
      <div>
        <div class="card-content">
          <h4>{{point.shop_name}}</h4>
          <p>{{point.address}}</p>
          <template is="dom-if" if="{{surcharge}}">
            <div class="surcharge">surcharge: â‚¹<span>{{surcharge}}</span></div>
          </template>
        </div>
      </div>
    </paper-card>
  </template>

  <script>
    (function() {
      Polymer({
        is: 'kyash-point',
        properties: {
          order: {
            type: Object
          },
          ele: {
            type: Number,
            value: 0
          },
          surcharge: {
            type: Number,
            computed: 'getSurcharge(order)'
          },
          point: {
            type: Object,
            notify: true
          }
        },

        attached: function () {
          if(this.point.match) {
            this.fire('tap');
          }
        },

        toggleSelect: function() {
          this.ele = this.ele === 0? 3: 0;
        },

        getSurcharge: function(order) {
          if(this.point.surcharge > 0 && order.amount < this.point.surcharge_till) {
            return this.point.surcharge;
          }
          else {
            return 0;
          }
        }
      });
    })();
  </script>
</dom-module>
